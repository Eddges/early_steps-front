<!DOCTYPE html>
<html class="no-js css-menubar" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Take advantage of this lockdown. Give an early start to your leadership journey!">
    <meta name="author" content="CodeAsylums">
    
    <title>Early Steps</title>
<!--     
    <link rel="apple-touch-icon" href="../../assets/images/apple-touch-icon.png">
    <link rel="shortcut icon" href="../../assets/images/favicon.ico"> -->
    
    <link rel="apple-touch-icon" href="../../assets/images/favicon.png">
    <link rel="shortcut icon" href="../../assets/images/favicon.png">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../../global/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../global/css/bootstrap-extend.min.css">
    <link rel="stylesheet" href="../../../global/css/styles.css">
    <link rel="stylesheet" href="../../assets/css/site.min.css">
    
    <!-- Plugins -->
    <link rel="stylesheet" href="../../../global/vendor/animsition/animsition.css">
    <link rel="stylesheet" href="../../../global/vendor/asscrollable/asScrollable.css">
    <link rel="stylesheet" href="../../../global/vendor/switchery/switchery.css">
    <link rel="stylesheet" href="../../../global/vendor/intro-js/introjs.css">
    <link rel="stylesheet" href="../../../global/vendor/slidepanel/slidePanel.css">
    <link rel="stylesheet" href="../../../global/vendor/flag-icon-css/flag-icon.css">
    <link rel="stylesheet" href="../../assets/examples/css/pages/register-v3.css">
    
    
    <!-- Fonts -->
    <link rel="stylesheet" href="../../../global/fonts/web-icons/web-icons.min.css">
    <link rel="stylesheet" href="../../../global/fonts/brand-icons/brand-icons.min.css">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>
    
    <!--[if lt IE 9]>
    <script src="../../../global/vendor/html5shiv/html5shiv.min.js"></script>
    <![endif]-->
    
    <!--[if lt IE 10]>
    <script src="../../../global/vendor/media-match/media.match.min.js"></script>
    <script src="../../../global/vendor/respond/respond.min.js"></script>
    <![endif]-->
    
    <!-- Scripts -->
    <script src="../../../global/vendor/breakpoints/breakpoints.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.5.0/js/md5.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      Breakpoints();
    </script>
  </head>
  <body class="animsition  layout-full yellowBG">
    <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->


    <!-- Page -->
    <div class="page vertical-align text-center yellowBG" data-animsition-in="fade-in" data-animsition-out="fade-out">>
      <div class="page-content vertical-align-middle animation-slide-top animation-duration-1">
        <div class="panel">
          <!-- alert message -->
          <div class="alert dark alert-info alert-dismissible animation-slide-top " id="processing-div" style="display:none" role="alert">
            <button type="button" class="close" onClick="hidemepro()" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
            <div id="message-processing"></div>
          </div>
  <!-- End alert message -->


 <!-- alert message -->
 <div class="alert dark alert-danger alert-dismissible animation-slide-top " id="alert-message-div" style="display:none" role="alert">
            <button type="button" class="close" onClick="hideme()" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
            <div id="message-div"></div>
          </div>
  <!-- End alert message -->
  

<!-- alert message -->
 <div class="alert dark alert-success alert-dismissible animation-slide-top " id="info-message-div" style="display:none" role="alert">
            <button type="button" class="close" onClick="hidemeinfo()" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
            <div id="message-div-info"></div>
          </div>
  <!-- End alert message -->

          <div class="panel-body">
            <div class="brand">
              <img class="brand-img" src="../../assets//images/EarlyStepsLogo.webp" alt="..." style="width:80%">
              
            </div>
            <form style='padding-top : 15px;'>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="email" type="email" class="form-control" name="email" required="required"/>
                <label class="floating-label">Email</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="phone" type="phone" class="form-control" name="phone" required="required"/>
                <label class="floating-label">Phone</label>
              </div>
              <!-- <div class="form-group form-material floating" data-plugin="formMaterial">
                <input onclick="clearAlert()" id="username" type="text" class="form-control" name="username" required="required" onfocus="(this.type='date')"/>
                <label class="floating-label">UserName</label>
              </div> -->
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="fname" type="text" class="form-control" name="username" required="required"/>
                <label class="floating-label">First Name</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="lname" type="text" class="form-control" name="username" required="required"/>
                <label class="floating-label">Last Name</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="dob" type="text" class="form-control" name="username" required="required" onfocus="(this.type='date')"/>
                <label class="floating-label">Date of Birth</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="grade" type="number" class="form-control" name="username" required="required"/>
                <label class="floating-label">Class / Grade</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="password" type="password" class="form-control" name="password" required="required"/>
                <label class="floating-label">Password</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial" style='margin : 20px 0px !important;'>
                <input onclick="clearAlert()" id="retypePassword" type="password" class="form-control" name="PasswordCheck" required="required"/>
                <label class="floating-label">Confirm Password</label>
              </div>
              <!-- <div class="form-group form-material" data-plugin="formMaterial">
                <label class="form-control-label"></label>
                <select class="form-control" id="course_id" required="required" name="default" >
                  <option value="0">Select Course</option>
                    <option value="1000">Not Enrolled</option>
                    <option value="1">Virgin Algorithm - 4th April 2020</option>
                    <option value="2">Virgin Algorithm - 12th April 2020</option>
                    <option value="3">Full Stack - 12th April 2020</option>
                    <option value="4">Machine Learning - 12th April 2020</option>
                    <option value="5">Virgin Algorithm - 19th April 2020</option>
                    <option value="6">Machine Learning - 19th April 2020</option>
                    <option value="7">Full Stack - 19th April 2020</option>
                    <option value="7">Data Analytics - 19th April 2020</option>
                    <option value="5">Virgin Algorithm - 26th April 2020</option>
                    <option value="6">Machine Learning - 26th April 2020</option>
                    <option value="7">Full Stack - 26th April 2020</option>
                    <option value="7">Data Analytics - 26th April 2020</option>
                  </select>
            </div> -->
              <a class="btn esButton textLight btn-block btn-lg mx-auto" onclick="doregistration();" style="color:white;">Sign up</a>
            </form>
            <p>Have an account already? Please go to <a class='coral' href="login">Sign In</a></p>
          </div>
        </div>

        <footer class="page-copyright page-copyright-inverse">
           <p class='grey'>Early Steps</p>
          <p class='grey'>© 2020. All RIGHT RESERVED.</p>
         
        </footer>
      </div>
    </div>
    <!-- End Page -->


    <!-- Core  -->
    <script src="../../../global/vendor/babel-external-helpers/babel-external-helpers.js"></script>
    <script src="../../../global/vendor/jquery/jquery.js"></script>
    <script src="../../../global/vendor/popper-js/umd/popper.min.js"></script>
    <script src="../../../global/vendor/bootstrap/bootstrap.js"></script>
    <script src="../../../global/vendor/animsition/animsition.js"></script>
    <script src="../../../global/vendor/mousewheel/jquery.mousewheel.js"></script>
    <script src="../../../global/vendor/asscrollbar/jquery-asScrollbar.js"></script>
    <script src="../../../global/vendor/asscrollable/jquery-asScrollable.js"></script>
    <script src="../../../global/vendor/ashoverscroll/jquery-asHoverScroll.js"></script>
    
    <!-- Plugins -->
    <script src="../../../global/vendor/switchery/switchery.js"></script>
    <script src="../../../global/vendor/intro-js/intro.js"></script>
    <script src="../../../global/vendor/screenfull/screenfull.js"></script>
    <script src="../../../global/vendor/slidepanel/jquery-slidePanel.js"></script>
        <script src="../../../global/vendor/jquery-placeholder/jquery.placeholder.js"></script>
    
    <!-- Scripts -->
    <script src="../../../global/js/Component.js"></script>
    <script src="../../../global/js/Plugin.js"></script>
    <script src="../../../global/js/Base.js"></script>
    <script src="../../../global/js/Config.js"></script>
    
    <script src="../../assets/js/Section/Menubar.js"></script>
    <script src="../../assets/js/Section/GridMenu.js"></script>
    <script src="../../assets/js/Section/Sidebar.js"></script>
    <script src="../../assets/js/Section/PageAside.js"></script>
    <script src="../../assets/js/Plugin/menu.js"></script>
    
    <script src="../../../global/js/config/colors.js"></script>
    <script src="../../assets/js/config/tour.js"></script>
    <script>Config.set('assets', '../../assets');</script>
    
    <!-- Page -->
    <script src="../../assets/js/Site.js"></script>
    <script src="../../../global/js/Plugin/asscrollable.js"></script>
    <script src="../../../global/js/Plugin/slidepanel.js"></script>
    <script src="../../../global/js/Plugin/switchery.js"></script>
    <script src="../../../global/js/Plugin/jquery-placeholder.js"></script>
    <script src="../../../global/js/Plugin/material.js"></script>
    
    <script>
    
    // var url= 'https://early-steps.herokuapp.com/';
    var url = 'http://earlysteps-env-2.eba-7ipamjqn.us-west-2.elasticbeanstalk.com/'
    // var url= 'https://api.codeasylums.com/';

    function hideme(){
      document.getElementById('alert-message-div').style.display="none";
    }

    function hidemeinfo(){
      document.getElementById('info-message-div').style.display="none";
    }

     function hidemepro(){
      document.getElementById('processing-div').style.display="none";
    }


      (function(document, window, $){
        'use strict';
    
        var Site = window.Site;
        $(document).ready(function(){
          Site.run();
        });
      })(document, window, jQuery);

      async function doregistration(){

        window.scrollTo(0,0);
        document.getElementById('processing-div').style.display="block";
                document.getElementById('message-processing').innerHTML="Processing...";

                
        // let usernameValue = document.getElementById("username").value;
        let emailValue = document.getElementById("email").value;
        let phoneValue = document.getElementById("phone").value;
        let passwordValue = md5(document.getElementById("password").value);
        let retypepasswordValue = md5(document.getElementById("retypePassword").value);
        let usernameValue = phoneValue;

        let fname = document.getElementById('fname').value
        let lname = document.getElementById('lname').value
        let dob = document.getElementById('dob').value

        let grade = document.getElementById('grade').value

        // document.getElementById('fname').addEventListener('change', e => {
        //   console.log('e.target.value')
        //   lname = e.target.value
        // })

        // document.getElementById('fname').addEventListener('change', e => {
        //   console.log('e.target.value')
        //   lname = e.target.value
        // })



        // if(usernameValue==""){
        //     document.getElementById('alert-message-div').style.display="block";
        //     document.getElementById('message-div').innerHTML="Username is required";
        //     document.getElementById('processing-div').style.display="none";
        //     return false;
        // }
         if(emailValue==""){
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Email is required";
            document.getElementById('processing-div').style.display="none";
            return false;
        }

        // if(document.getElementById('course_id').value==="0")
        // {
        //   document.getElementById('alert-message-div').style.display="block";
        //   document.getElementById('message-div').innerHTML="Select Course";
        //   return false;          
        // }
          
          //var mailformat = /^w+([.-]?w+)*@w+([.-]?w+)*(.w{2,3})+$/;
          var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        
          if(!regex.test(emailValue))
          {
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="You have entered an invalid email address!";
            document.getElementById('processing-div').style.display="none";
            return false;
          }
        
          

         if(phoneValue==""){
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Phone is required";
            document.getElementById('processing-div').style.display="none";
            return false;
        }

        var phoneno = /^\d{10}$/;
        if(!(phoneValue.match(phoneno)))
        {
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Please enter 10 digit phone number";
            document.getElementById('processing-div').style.display="none";
            return false;
        }
      
         if(document.getElementById("password").value==""){
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Password is required";
            document.getElementById('processing-div').style.display="none";
            return false;
        }
         if(document.getElementById("retypePassword").value==""){
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Confirm password is required";
            document.getElementById('processing-div').style.display="none";
            return false;
        }
         if(document.getElementById("retypePassword").value!=document.getElementById("password").value){
            document.getElementById('alert-message-div').style.display="block";
            document.getElementById('message-div').innerHTML="Passwords do not match";
            document.getElementById('processing-div').style.display="none";
            return false;
        }


        let userTypeValue = "student";
        let redirectURL = "/login";
        var flag1 = true;
        var flag2 = true
       // console.log(flag1,flag2)
      await axios.get( url+`/isRegisteredUserEmail/`+`${emailValue}`)
        .then((res)=>{
          if(res.data==="True")
            {
               document.getElementById('alert-message-div').style.display="block";
                document.getElementById('message-div').innerHTML="Email already registered!";
                document.getElementById('processing-div').style.display="none";

          //return false;
           
          }
        })
        .catch(async (err)=>{
          flag1 = false;
         // console.log(flag1,flag2)
          await axios.get( url+`/isRegisteredUserPhone/`+`${phoneValue}`)
              .then((res)=>{
                if(res.data==="True")
                {
                    document.getElementById('alert-message-div').style.display="block";
                    document.getElementById('message-div').innerHTML="Phone number already registered!";
                    document.getElementById('processing-div').style.display="none";

          //return false;
                            
                }
              })
              .catch((err)=>{
                flag2 = false;
                //console.log(flag1,flag2)
              }
                )  
        })


        if (flag1 === false && flag2 === false){
           if (passwordValue === retypepasswordValue) {
              console.log("reg", {
                user_id: phoneValue,
                user_type: userTypeValue,
                first_name: fname,
                last_name: lname,
                dob: dob,
                grade: grade,
                user_name: phoneValue,
                phone: phoneValue,
                email: emailValue,
                password: passwordValue
                })

             
              axios.post( url+'/doRegistration', {
                user_id: phoneValue,
                user_type: userTypeValue,
                first_name: fname,
                last_name: lname,
                dob: dob,
                grade: grade,
                user_name: phoneValue,
                phone: phoneValue,
                email: emailValue,
                password: passwordValue
                })
                .then(function (response) {
                  console.log('Response, ', response.data)
                  document.getElementById('processing-div').style.display="none";
                  document.getElementById('info-message-div').style.display="block";
                  document.getElementById('message-div-info').innerHTML="Registered successfully!";
                  setTimeout(()=>{
                    window.location.href = redirectURL;
                  },1500);
                 
                })
                .catch(function (error) {
                  //console.log(error);
                  document.getElementById('alert-message-div').style.display="block";
                  document.getElementById('message-div').innerHTML="User Name already registered!";
                  document.getElementById('processing-div').style.display="none";

                });
            }
        }
      }
      function clearAlert(){
          document.getElementById('alert-message-div').style.display="none";
        }    
    </script>
  </body>
</html>
