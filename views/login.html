
<!DOCTYPE html>
<html class="no-js css-menubar" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Best Coding Bootcamp in India">
    <meta name="author" content="CodeAsylums">
    
    <title>CodeAsylums</title>
    
    <link rel="apple-touch-icon" href="../../assets/images/logo-ca.png">
    <link rel="shortcut icon" href="../../assets/images/logo-ca.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../../global/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../global/css/bootstrap-extend.min.css">
    <link rel="stylesheet" href="../../assets/css/site.min.css">
    
    <!-- Plugins -->
    <link rel="stylesheet" href="../../../global/vendor/animsition/animsition.css">
    <link rel="stylesheet" href="../../../global/vendor/asscrollable/asScrollable.css">
    <link rel="stylesheet" href="../../../global/vendor/switchery/switchery.css">
    <link rel="stylesheet" href="../../../global/vendor/intro-js/introjs.css">
    <link rel="stylesheet" href="../../../global/vendor/slidepanel/slidePanel.css">
    <link rel="stylesheet" href="../../../global/vendor/flag-icon-css/flag-icon.css">
    <link rel="stylesheet" href="../../assets/examples/css/pages/login-v3.css">
    
    
    <!-- Fonts -->
    <link rel="stylesheet" href="../../../global/fonts/web-icons/web-icons.min.css">
    <link rel="stylesheet" href="../../../global/fonts/brand-icons/brand-icons.min.css">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>
    
    <!--[if lt IE 9]>
    <script src="../../../global/vendor/html5shiv/html5shiv.min.js"></script>
    <![endif]-->
    
    <!--[if lt IE 10]>
    <script src="../../../global/vendor/media-match/media.match.min.js"></script>
    <script src="../../../global/vendor/respond/respond.min.js"></script>
    <![endif]-->
    
    <!-- Scripts -->
    <script src="../../../global/vendor/breakpoints/breakpoints.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.5.0/js/md5.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


    <script>
      Breakpoints();
    </script>
  </head>
  <body class="animsition page-login-v3 layout-full">
    <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->


    <!-- Page -->
    <div class="page vertical-align text-center" data-animsition-in="fade-in" data-animsition-out="fade-out">>

    
      <div class="page-content vertical-align-middle animation-slide-top animation-duration-1">
        <div class="panel">
        <!-- alert message -->
         <div class="alert dark alert-danger alert-dismissible animation-slide-top " id="alert-message-div" style="display:none" role="alert">
                    <button type="button" class="close" onClick="hideme()" aria-label="Close">
                      <span aria-hidden="true">×</span>
                    </button>
                    <div id="message-div"></div>
                  </div>
          <!-- End alert message -->
          <div class="panel-body">
            <div class="brand">
              <img class="brand-img" src="../../assets//images/logo-ca.png" alt="..." style="width:40%">
              
            </div>
           
            <form>
              <div class="form-group form-material floating" data-plugin="formMaterial">
                <input onclick="clearAlert()" id="userEmailOrPhone" type="text" class="form-control" name="email" />
                <label class="floating-label">Email/Phone</label>
              </div>
              <div class="form-group form-material floating" data-plugin="formMaterial">
                <input onclick="clearAlert()" id="password" type="password" class="form-control" name="password" />
                <label class="floating-label">Password</label>
              </div>
              <!-- <div class="form-group form-material">
                <label class="form-control-label"></label>
                <select class="form-control" id="course_id" required="required" name="default" >
                  <option value="0">Select Course</option>
                    <option value="100">Not Enrolled</option>
                    <option value="1">Virgin Algorithm - 4th April 2020</option>
                    <option value="2">Virgin Algorithm - 12th April 2020</option>
                    <option value="3">Full Stack - 12th April 2020</option>
                    <option value="4">Machine Learning - 12th April 2020</option>
                    <option value="5">Virgin Algorithm - 19th April 2020</option>
                    <option value="6">Machine Learning - 19th April 2020</option>
                    <option value="7">Full Stack - 19th April 2020</option>
                    <option value="7">Data Analytics - 19th April 2020</option>
                    <option value="5">Virgin Algorithm - 26th April 2020</option>
                    <option value="6">Machine Learning - 26th April 2020</option>
                    <option value="7">Full Stack - 26th April 2020</option>
                    <option value="7">Data Analytics - 26th April 2020</option>
                  </select>
            </div> -->
              <div class="form-group clearfix">
              <!--  <div class="checkbox-custom checkbox-inline checkbox-primary checkbox-lg float-left">
                  <input type="checkbox" id="inputCheckbox" name="remember">
                  <label for="inputCheckbox">Remember me</label>
                </div>
                <a class="float-right" href="forgot-password.html">Forgot password?</a> -->
              </div>
                  <a class="btn btn-primary btn-block btn-lg mx-auto" onclick="doLogin();" style="color:white;">Sign in</a>
            </form>
            <p>Still no account? Please go to <a href="register">Sign up</a></p>
          </div>
        </div>

        <footer class="page-copyright page-copyright-inverse">
          <p>CODEASYLUMS</p>
          <p>© 2020. All RIGHT RESERVED.</p>
         
        </footer>
      </div>
    </div>
    <!-- End Page -->


    <!-- Core  -->
    <script src="../../../global/vendor/babel-external-helpers/babel-external-helpers.js"></script>
    <script src="../../../global/vendor/jquery/jquery.js"></script>
    <script src="../../../global/vendor/popper-js/umd/popper.min.js"></script>
    <script src="../../../global/vendor/bootstrap/bootstrap.js"></script>
    <script src="../../../global/vendor/animsition/animsition.js"></script>
    <script src="../../../global/vendor/mousewheel/jquery.mousewheel.js"></script>
    <script src="../../../global/vendor/asscrollbar/jquery-asScrollbar.js"></script>
    <script src="../../../global/vendor/asscrollable/jquery-asScrollable.js"></script>
    <script src="../../../global/vendor/ashoverscroll/jquery-asHoverScroll.js"></script>
    
    <!-- Plugins -->
    <script src="../../../global/vendor/switchery/switchery.js"></script>
    <script src="../../../global/vendor/intro-js/intro.js"></script>
    <script src="../../../global/vendor/screenfull/screenfull.js"></script>
    <script src="../../../global/vendor/slidepanel/jquery-slidePanel.js"></script>
        <script src="../../../global/vendor/jquery-placeholder/jquery.placeholder.js"></script>
    
    <!-- Scripts -->
    <script src="../../../global/js/Component.js"></script>
    <script src="../../../global/js/Plugin.js"></script>
    <script src="../../../global/js/Base.js"></script>
    <script src="../../../global/js/Config.js"></script>
    
    <script src="../../assets/js/Section/Menubar.js"></script>
    <script src="../../assets/js/Section/GridMenu.js"></script>
    <script src="../../assets/js/Section/Sidebar.js"></script>
    <script src="../../assets/js/Section/PageAside.js"></script>
    <script src="../../assets/js/Plugin/menu.js"></script>
    
    <script src="../../../global/js/config/colors.js"></script>
    <script src="../../assets/js/config/tour.js"></script>
    <script>Config.set('assets', '../../assets');</script>
    
    <!-- Page -->
    <script src="../../assets/js/Site.js"></script>
    <script src="../../../global/js/Plugin/asscrollable.js"></script>
    <script src="../../../global/js/Plugin/slidepanel.js"></script>
    <script src="../../../global/js/Plugin/switchery.js"></script>
    <script src="../../../global/js/Plugin/jquery-placeholder.js"></script>
    <script src="../../../global/js/Plugin/material.js"></script>
    
    <script>
       var url= '<%= process.env.URL %>';

    function hideme(){
      document.getElementById('alert-message-div').style.display="none";
    }


      (function(document, window, $){
        'use strict';
    
        var Site = window.Site;
        $(document).ready(function(){
          Site.run();
          
        });
      })(document, window, jQuery);

      function doLogin() {
        let userEmailOrPhoneValue = document.getElementById("userEmailOrPhone").value;
        let passwordValue = md5(document.getElementById("password").value);
        
        if(userEmailOrPhoneValue==""){
          document.getElementById('alert-message-div').style.display="block";
          document.getElementById('message-div').innerHTML="Email or Phone is required";
          return false;
        }

        if(document.getElementById("password").value==""){
           document.getElementById('alert-message-div').style.display="block";
          document.getElementById('message-div').innerHTML="Password is required";
          return false;
        }

        // if(document.getElementById('course_id').value==="0")
        // {
        //   document.getElementById('alert-message-div').style.display="block";
        //   document.getElementById('message-div').innerHTML="Select Course";
        //   return false;          
        // }
        
        let userTypeValue = "student";
        let redirectURL = "./profile";

        // CP : 1 - Template v1 - Working 
        // alert (userEmailOrPhoneValue);
        // alert(passwordValue);
        // window.location.href = "./register";

        // Input is string, i.e, email
        if (isNaN(userEmailOrPhoneValue)) {
          axios.get( url+`/isValidUserEmail?email=${userEmailOrPhoneValue}&password=${passwordValue}&user_type=${userTypeValue}`)
          .then(function (response) {
            console.log(response);
            if(response.data==="False"){
              document.getElementById('alert-message-div').style.display="block";
              document.getElementById('message-div').innerHTML="You have entered an invalid email address or password!";              
            }
            else{
              axios.get( url+`/getPhoneByEmail/${userEmailOrPhoneValue}`)
            .then(function (response) {
              console.log(response);
              sessionStorage.setItem("user_id", response.data["a"][0].phone);
              sessionStorage.setItem("loggedCA", md5("true"));
              getProgrammingProfileData()
            }).catch(function (error){
              console.log(error);
              document.getElementById('alert-message-div').style.display="block";
              document.getElementById('message-div').innerHTML="Something went wrong, Please try again!!";              

            });
            }

          }).catch(function(error) {
              console.log(error);
              document.getElementById('alert-message-div').style.display="block";
              document.getElementById('message-div').innerHTML="Invalid Credentials, Please verify!";              
          });
        } else {    
    // Input is number
    axios.get( url+`/isValidUserPhone?phone=${userEmailOrPhoneValue}&password=${passwordValue}&user_type=${userTypeValue}`)
    .then(function (response){
        console.log(response);
        if(response.data==="False"){
          document.getElementById('alert-message-div').style.display="block";
          document.getElementById('message-div').innerHTML="Invalid Credentials, Please verify!";     
        }
        else{
          sessionStorage.setItem("user_id", userEmailOrPhoneValue);
          sessionStorage.setItem("loggedCA", md5("true"));
          getProgrammingProfileData();
        }
      }).catch(function (error){
        console.log(error);
        document.getElementById('alert-message-div').style.display="block";
        document.getElementById('message-div').innerHTML="Invalid Credentials, Please verify!";              

      });
  }   
      }

      function getProgrammingProfileData() {
            let user_id = sessionStorage.getItem("user_id");
            axios.get( url+`/getProgrammingProfile/` + `${user_id}
                    `)
                .then(res => {
                  // sessionStorage.setItem("course_id", document.getElementById("course_id").value);
                    // if(document.getElementById("course_id").value==="1000")
                    // {
                    //   window.location.href = "./dashboard-others";                     }
                    // else
                    // {
                        sessionStorage.setItem("redirect", "home");
                        if(res.data.a.length!=0){
                        window.location.href = "./home"; 
                      }
                      else{
                        window.location.href = "./profileothers"; 
                      }                      
                    // }
                })
                .catch(err => console.log(err))
        }
        function clearAlert(){
          document.getElementById('alert-message-div').style.display="none";
        }      
    </script>
  </body>
</html>
